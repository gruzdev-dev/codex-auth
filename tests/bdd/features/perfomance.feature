Feature: Производительность массовой регистрации (Load Testing)
  Как Системный Администратор
  Я хочу оценить пропускную способность API регистрации
  Чтобы спланировать окна обслуживания для миграции 100,000 пользователей

  Background:
    Given база данных очищена

  Scenario: Сравнение пропускной способности алгоритмов
    Given я подготавливаю набор данных из 100 пользователей
    
    # Этап 1: "Быстрый" алгоритм (эмуляция)
    When я переключаю систему на алгоритм "SHA256"
    And я отправляю запросы на регистрацию всех пользователей через API
    Then все пользователи должны быть успешно созданы в БД
    And я фиксирую время выполнения как "Time_SHA256"

    # Этап 2: "Тяжелый" алгоритм
    When база данных очищена
    And я переключаю систему на алгоритм "Bcrypt"
    And я отправляю запросы на регистрацию всех пользователей через API
    Then все пользователи должны быть успешно созданы в БД
    And я фиксирую время выполнения как "Time_Bcrypt"
    
    # Сравнение
    And "Time_SHA256" должно быть меньше "Time_Bcrypt" минимум в 10 раз

  Scenario Outline: Нагрузочное тестирование
    Given я генерирую датасет размером <count> записей
    When я переключаю систему на алгоритм "Bcrypt"
    And я выполняю массовую регистрацию через API
    Then время обработки не должно превышать <max_minutes> минут
    And потребление памяти не должно превышать <max_mb> Мб

    Examples:
      | count | max_minutes | max_mb |
      | 5000  | 5           | 5      |